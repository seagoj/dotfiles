#!/bin/sh
# vim: sw=4 ts=4 sts=4 noexpandtab

doc_type="$1"
doc_root="$2"
doc_name="$3"

# create doc_root if needed
if [[ ! -d "$doc_root" ]]; then
	mkdir -p "$doc_root"
fi

entry="$doc_root"/"$doc_name".md
if [[ ! -f "$entry" ]]; then
	if [[ ! -f "$doc_root"/index.md ]]; then
		cat << INDEX > "$doc_root/index.md"
# $doc_type


INDEX
	fi
	sed -i "3i\\- [$doc_name]($doc_name.md)" "$doc_root"/index.md
	cat << EOF > "$entry"
# $doc_name


EOF
	ln -sf ./"$doc_name".md "$doc_root/latest.md"
fi

nvim +3 "$entry"
