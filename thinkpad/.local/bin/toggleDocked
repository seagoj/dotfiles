#!/bin/bash

IN_RES=1920x1080
EXT_RES=1920x1200

int_ports=( LVDS1 LVDS-1 )
ext_ports=( HDMI2 HDMI-2 DP1 DP2 )

findPort() {
    local ports=("$@")

    for i in "${ports[@]}"; do
        if xrandr | grep "${i} connected" >/dev/null; then
            echo "${i}"
            exit
        fi
    done
}

IN=$(findPort "${int_ports[@]}")
EXT=$(findPort "${ext_ports[@]}")

echo "IN: $IN"
echo "EXT: $EXT"

if [[ -z "$IN" ]]; then
    echo "No internal port found."
    exit 1
fi

xrandr --output $IN --mode $IN_RES

if [[ -z "$EXT" ]]; then
    for i in "${ext_ports[@]}"; do
        xrandr --output $EXT --off 2>/dev/null
    done
    # sudo dockd --config undocked
    notify-send -u low "Undocked"
else
    xrandr --output $EXT --mode $EXT_RES --right-of $IN
    # sudo dockd --config docked
    notify-send -u low "Docked"
fi
